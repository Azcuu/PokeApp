<div class="team-details-page">
  <div class="team-header">
    <a routerLink="/my-teams" class="back-button">
      <i class="fas fa-arrow-left"></i> Volver a mis equipos
    </a>

    <div class="team-title-section">
      <h1 class="team-title">{{ team?.name || 'Cargando...' }}</h1>
    </div>

    <div class="team-actions" *ngIf="isOwner">
      <button class="btn-edit" [routerLink]="['/teams', teamId, 'edit']">
        <i class="fas fa-edit"></i> Editar
      </button>
      <button class="btn-delete" (click)="deleteTeam()">
        <i class="fas fa-trash"></i> Eliminar
      </button>
    </div>
  </div>

  <div class="loading-state" *ngIf="loading">
    <div class="loading-spinner"></div>
    <p>Cargando detalles del equipo...</p>
  </div>

  <div class="error-state" *ngIf="error && !loading">
    <div class="error-message">
      <i class="fas fa-exclamation-triangle"></i>
      <h3>Error al cargar el equipo</h3>
      <p>{{ error }}</p>
      <button class="btn-retry" (click)="loadTeam()">
        <i class="fas fa-redo"></i> Reintentar
      </button>
    </div>
  </div>

  <div class="team-content" *ngIf="!loading && !error && team">
    <div class="team-description-card">
      <h2><i class="fas fa-info-circle"></i> Descripción</h2>
      <p>{{ team.description || 'Este equipo no tiene descripción.' }}</p>
    </div>

    <div class="stats-section">
      <div class="stat-card">
        <h3><i class="fas fa-chart-bar"></i> Estadísticas del equipo</h3>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-label">Tipos únicos</span>
            <span class="stat-value">{{ uniqueTypes }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Pokémon legendarios</span>
            <span class="stat-value">{{ legendaryCount }}</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Pokémon míticos</span>
            <span class="stat-value">{{ mythicalCount }}</span>
          </div>
        </div>
      </div>
    </div>

    <div class="pokemon-section">
      <h2><i class="fas fa-dragon"></i> Pokémon en el equipo</h2>

      <div class="pokemon-grid" *ngIf="team.pokemons && team.pokemons.length > 0">
        <div class="pokemon-card" *ngFor="let pokemon of team.pokemons; let i = index">
          <div class="pokemon-header">
            <span class="pokemon-number">#{{ pokemon.pokemonId.toString().padStart(3, '0') || '???' }}</span>
            <h3 class="pokemon-name">{{ pokemon.name | titlecase }}</h3>
          </div>

          <div class="pokemon-image">
            <img [src]="pokemon.sprite || '/pokeball.png'"
                 [alt]="pokemon.name"
                 (error)="pokemon.sprite = '/pokeball.png'"
                 class="pokemon-sprite">
            <div class="pokemon-position">#{{ i + 1 }}</div>
          </div>

          <div class="pokemon-info">
            <div class="pokemon-types">
              <span class="type-badge" *ngFor="let type of getPokemonTypes(pokemon)"
                    [class]="'type-' + type.toLowerCase()">
                {{ type }}
              </span>
            </div>

            <div class="pokemon-stats">
              <!-- HP -->
              <div class="stat-row">
                <span>HP</span>
                <span class="stat-value-text">{{ getPokemonStatValue(pokemon, 'HP') }}</span>
                <div class="stat-bar">
                  <div class="stat-fill"
                       [style.width.%]="getStatPercentage(getPokemonStatValue(pokemon, 'HP'), 'HP')"
                       [style.background]="'linear-gradient(90deg, ' + getStatColor('HP') + ', ' + getStatColor('HP') + 'dd)'">
                  </div>
                </div>
              </div>

              <!-- Ataque -->
              <div class="stat-row">
                <span>Ataque</span>
                <span class="stat-value-text">{{ getPokemonStatValue(pokemon, 'Ataque') }}</span>
                <div class="stat-bar">
                  <div class="stat-fill"
                       [style.width.%]="getStatPercentage(getPokemonStatValue(pokemon, 'Ataque'), 'Ataque')"
                       [style.background]="'linear-gradient(90deg, ' + getStatColor('Ataque') + ', ' + getStatColor('Ataque') + 'dd)'">
                  </div>
                </div>
              </div>

              <!-- Defensa -->
              <div class="stat-row">
                <span>Defensa</span>
                <span class="stat-value-text">{{ getPokemonStatValue(pokemon, 'Defensa') }}</span>
                <div class="stat-bar">
                  <div class="stat-fill"
                       [style.width.%]="getStatPercentage(getPokemonStatValue(pokemon, 'Defensa'), 'Defensa')"
                       [style.background]="'linear-gradient(90deg, ' + getStatColor('Defensa') + ', ' + getStatColor('Defensa') + 'dd)'">
                  </div>
                </div>
              </div>

              <!-- Ataque Especial -->
              <div class="stat-row">
                <span>Ataque Especial</span>
                <span class="stat-value-text">{{ getPokemonStatValue(pokemon, 'Ataque Especial') }}</span>
                <div class="stat-bar">
                  <div class="stat-fill"
                       [style.width.%]="getStatPercentage(getPokemonStatValue(pokemon, 'Ataque Especial'), 'Ataque Especial')"
                       [style.background]="'linear-gradient(90deg, ' + getStatColor('Ataque Especial') + ', ' + getStatColor('Ataque Especial') + 'dd)'">
                  </div>
                </div>
              </div>

              <!-- Defensa Especial -->
              <div class="stat-row">
                <span>Defensa Especial</span>
                <span class="stat-value-text">{{ getPokemonStatValue(pokemon, 'Defensa Especial') }}</span>
                <div class="stat-bar">
                  <div class="stat-fill"
                       [style.width.%]="getStatPercentage(getPokemonStatValue(pokemon, 'Defensa Especial'), 'Defensa Especial')"
                       [style.background]="'linear-gradient(90deg, ' + getStatColor('Defensa Especial') + ', ' + getStatColor('Defensa Especial') + 'dd)'">
                  </div>
                </div>
              </div>

              <!-- Velocidad -->
              <div class="stat-row">
                <span>Velocidad</span>
                <span class="stat-value-text">{{ getPokemonStatValue(pokemon, 'Velocidad') }}</span>
                <div class="stat-bar">
                  <div class="stat-fill"
                       [style.width.%]="getStatPercentage(getPokemonStatValue(pokemon, 'Velocidad'), 'Velocidad')"
                       [style.background]="'linear-gradient(90deg, ' + getStatColor('Velocidad') + ', ' + getStatColor('Velocidad') + 'dd)'">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="pokemon-actions">
            <button class="btn-view-pokemon" (click)="viewPokemonDetails(pokemon.pokemonId)">
              <i class="fas fa-eye"></i> Ver detalles
            </button>
            <button class="btn-remove" *ngIf="isOwner" (click)="removePokemon(pokemon)">
              <i class="fas fa-times"></i> Quitar
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="tags-section" *ngIf="team.tags && team.tags.length > 0">
      <h2><i class="fas fa-tags"></i> Etiquetas</h2>
      <div class="tags-container">
        <span class="tag" *ngFor="let tag of team.tags">
          #{{ tag }}
        </span>
      </div>
    </div>

    <div class="info-section">
      <div class="info-card">
        <h3><i class="fas fa-database"></i> Información del equipo</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">ID del equipo</span>
            <span class="info-value">{{ team._id }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Creado</span>
            <span class="info-value">{{ team.createdAt | date:'dd/MM/yyyy HH:mm' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Actualizado</span>
            <span class="info-value">{{ team.updatedAt | date:'dd/MM/yyyy HH:mm' }}</span>
          </div>
          <div class="info-item" *ngIf="team.creator">
            <span class="info-label">Creador</span>
            <span class="info-value">{{ team.creator.username || team.creatorName }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="footer-actions" *ngIf="!loading && !error">
    <button class="btn-share" (click)="shareTeam()" *ngIf="team?.isPublic">
      <i class="fas fa-share-alt"></i> Compartir equipo
    </button>
    <button class="btn-copy-link" (click)="copyTeamLink()">
      <i class="fas fa-link"></i> Copiar enlace
    </button>
    <a routerLink="/teams" class="btn-back-bottom">
      <i class="fas fa-arrow-left"></i> Ver todos los equipos
    </a>
  </div>
</div>
